<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCM BRAIN PRO - LISTA ATUALIZADA</title>
    <style>
        :root { --n-blue: #1e90ff; --n-green: #00ff88; --n-red: #ff3355; --bg: #05070a; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .logo { font-size: 22px; font-weight: 900; margin: 10px 0; }
        .logo span { color: var(--n-blue); }
        .painel-fin { background: #111418; border: 2px solid var(--n-green); border-radius: 15px; width: 95%; max-width: 500px; padding: 15px; margin-bottom: 10px; }
        .fin-row { display: flex; gap: 10px; margin-bottom: 10px; }
        .fin-group { flex: 1; }
        .fin-group label { font-size: 9px; color: #888; display: block; }
        .fin-input { width: 85%; background: #000; border: 1px solid #333; color: #fff; padding: 6px; border-radius: 5px; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; text-align: center; border-top: 1px solid #222; padding-top: 10px; }
        .stat-l { font-size: 8px; color: #888; text-transform: uppercase; }
        .stat-v { font-size: 13px; font-weight: bold; display: block; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; max-width: 500px; }
        .card { background: #111418; border-radius: 15px; padding: 10px; border: 1px solid #222; text-align: center; }
        .status-box { background: #000; padding: 8px; border-radius: 8px; margin: 8px 0; border: 1px solid #333; min-height: 45px; }
        .status-txt { font-size: 9px; color: var(--n-blue); font-weight: bold; display: block; }
        .price-txt { font-size: 11px; color: #f0b90b; font-family: monospace; margin-top: 4px; }
        .sel { background: #000; color: #fff; border: 1px solid #444; font-size: 10px; width: 100%; padding: 5px; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="logo">K.C<span>ðŸ“ˆ</span>M BRAIN PRO</div>

    <div class="painel-fin">
        <div class="fin-row">
            <div class="fin-group">
                <label>BANCA (R$)</label>
                <input type="number" id="inpBanca" class="fin-input" value="5000">
            </div>
            <div class="fin-group">
                <label>SIMULADOR (%)</label>
                <input type="number" id="inpSim" class="fin-input" value="1">
            </div>
        </div>
        <div class="stats-grid">
            <div><span class="stat-l">Banca Atual</span><span class="stat-v" id="v-banca">R$ 5000.00</span></div>
            <div><span class="stat-l">G</span><span class="stat-v" style="color:var(--n-green)" id="v-g">0</span></div>
            <div><span class="stat-l">R</span><span class="stat-v" style="color:var(--n-red)" id="v-r">0</span></div>
            <div><span class="stat-l">PrÃ³xima</span><span class="stat-v" id="v-ent">R$ 50.00</span></div>
        </div>
    </div>

    <div class="grid" id="main-grid"></div>

<script>
    const TOK = "8427077212:AAEiL_3_D_-fukuaR95V3FqoYYyHvdCHmEI";
    const CID = "-1003355965894";
    
    // NOVA LISTA DE ATIVOS
    const LISTA_COMPLETA = [
        { id: "NONE", nome: "âŒ DESATIVAR SLOT" },
        { id: "R_10", nome: "ðŸ“Š Volatility 10" },
        { id: "R_25", nome: "ðŸ“Š Volatility 25" },
        { id: "R_50", nome: "ðŸ“Š Volatility 50" },
        { id: "R_75", nome: "ðŸ“Š Volatility 75" },
        { id: "R_100", nome: "ðŸ“Š Volatility 100" },
        { id: "1HZ10V", nome: "ðŸ“ˆ Volatility 10 (1s)" },
        { id: "1HZ25V", nome: "ðŸ“ˆ Volatility 25 (1s)" },
        { id: "1HZ50V", nome: "ðŸ“ˆ Volatility 50 (1s)" },
        { id: "1HZ75V", nome: "ðŸ“ˆ Volatility 75 (1s)" },
        { id: "1HZ100V", nome: "ðŸ“ˆ Volatility 100 (1s)" },
        { id: "BOOM300", nome: "ðŸ’¥ Boom 300" },
        { id: "BOOM500", nome: "ðŸ’¥ Boom 500" },
        { id: "BOOM1000", nome: "ðŸ’¥ Boom 1000" },
        { id: "CRASH300", nome: "ðŸ“‰ Crash 300" },
        { id: "CRASH500", nome: "ðŸ“‰ Crash 500" },
        { id: "CRASH1000", nome: "ðŸ“‰ Crash 1000" },
        { id: "ST50", nome: "ðŸŽ¢ Step Index" },
        { id: "frxAUDUSD", nome: "ðŸ’± AUD/USD" },
        { id: "frxEURUSD", nome: "ðŸ’± EUR/USD" },
        { id: "frxGBPUSD", nome: "ðŸ’± GBP/USD" },
        { id: "frxNZDUSD", nome: "ðŸ’± NZD/USD" },
        { id: "frxUSDCAD", nome: "ðŸ’± USD/CAD" },
        { id: "frxUSDCHF", nome: "ðŸ’± USD/CHF" },
        { id: "frxUSDJPY", nome: "ðŸ’± USD/JPY" },
        { id: "frxAUDCAD", nome: "ðŸ’± AUD/CAD" },
        { id: "frxAUDCHF", nome: "ðŸ’± AUD/CHF" },
        { id: "frxAUDJPY", nome: "ðŸ’± AUD/JPY" },
        { id: "frxAUDNZD", nome: "ðŸ’± AUD/NZD" },
        { id: "frxEURAUD", nome: "ðŸ’± EUR/AUD" },
        { id: "frxEURCAD", nome: "ðŸ’± EUR/CAD" },
        { id: "frxEURCHF", nome: "ðŸ’± EUR/CHF" },
        { id: "frxEURGBP", nome: "ðŸ’± EUR/GBP" },
        { id: "frxEURJPY", nome: "ðŸ’± EUR/JPY" },
        { id: "frxEURNZD", nome: "ðŸ’± EUR/NZD" },
        { id: "frxGBPAUD", nome: "ðŸ’± GBP/AUD" },
        { id: "frxGBPCAD", nome: "ðŸ’± GBP/CAD" },
        { id: "frxGBPCHF", nome: "ðŸ’± GBP/CHF" },
        { id: "frxGBPJPY", nome: "ðŸ’± GBP/JPY" },
        { id: "frxGBPNZD", nome: "ðŸ’± GBP/NZD" },
        { id: "frxNZDJPY", nome: "ðŸ’± NZD/JPY" },
        { id: "frxUSDMXN", nome: "ðŸ’± USD/MXN" },    
        { id: "frxSGDJPY", nome: "ðŸ’± SGD/JPY" },
        { id: "frxEURNOK", nome: "ðŸ’± EUR/NOK" },
        { id: "frxEURPLN", nome: "ðŸ’± EUR/PLN" },
        { id: "frxEURSEK", nome: "ðŸ’± EUR/SEK" },
        { id: "frxUSDSGD", nome: "ðŸ’± USD/SGD" },
        { id: "frxXAUUSD", nome: "ðŸª™ OURO (XAU/USD)" },
        { id: "cryBTCUSD", nome: "â‚¿ BITCOIN (BTC/USD)" },
        { id: "cryETHUSD", nome: "â™¢ ETHEREUM (ETH/USD)" }
    ];

    let banca = 5000, g = 0, r = 0, motores = {};

    function sendTG(m, btn = false) {
        let u = `https://api.telegram.org/bot${TOK}/sendMessage?chat_id=${CID}&text=${encodeURIComponent(m)}&parse_mode=Markdown`;
        if(btn) {
            let kb = { inline_keyboard: [[{ text: "ðŸ‘‰ Clique agora!", url: "https://track.deriv.com/_S_W1N_" }]] };
            u += `&reply_markup=${encodeURIComponent(JSON.stringify(kb))}`;
        }
        fetch(u).catch(() => {});
    }

    function calcEMA(data, p) {
        if(!data || data.length < p) return 0;
        let k = 2/(p+1), ema = data[0].close;
        for(let i=1; i<data.length; i++) ema = (data[i].close * k) + (ema * (1-k));
        return ema;
    }

    function init(id, asset, name) {
        if(motores[id]?.ws) motores[id].ws.close();
        if(asset === "NONE") {
            document.getElementById(`st-${id}`).innerText = "OFF";
            document.getElementById(`pr-${id}`).innerText = "---";
            return;
        }

        let m = { name, ws: new WebSocket('wss://ws.binaryws.com/websockets/v3?app_id=1089'), v1: [], v5: [], ema: 0, p: "---" };

        m.ws.onopen = () => {
            m.ws.send(JSON.stringify({ ticks: asset }));
            m.ws.send(JSON.stringify({ ticks_history: asset, end: "latest", count: 30, granularity: 60, subscribe: 1 }));
            m.ws.send(JSON.stringify({ ticks_history: asset, end: "latest", count: 5, granularity: 300, subscribe: 1 }));
        };

        m.ws.onmessage = (e) => {
            let res = JSON.parse(e.data);
            if(res.tick) {
                m.p = res.tick.quote.toFixed(5);
                document.getElementById(`pr-${id}`).innerText = m.p;
            }
            if(res.candles) {
                if(res.echo_req.granularity === 60) m.v1 = res.candles;
                if(res.echo_req.granularity === 300) m.v5 = res.candles;
            }
            if(res.ohlc) {
                let o = res.ohlc;
                if(o.granularity === 60) {
                    m.v1[m.v1.length-1] = { open: o.open, close: o.close, high: o.high, low: o.low };
                    if(m.v1.length >= 20) m.ema = calcEMA(m.v1, 20);
                    if(parseInt(o.epoch) % 60 === 45) runLogic(id, true);
                    if(parseInt(o.epoch) % 60 === 0) runLogic(id, false);
                }
            }
            document.getElementById(`st-${id}`).innerText = m.ema > 0 ? `SISTEMA ATIVO` : `SINCRO...`;
        };
        motores[id] = m;
    }

    function runLogic(id, isPre) {
        let m = motores[id];
        if(!m || m.v1.length < 2 || m.v5.length < 1 || m.ema === 0) return;
        
        let c = m.v1[m.v1.length-1], a = m.v1[m.v1.length-2], t5 = m.v5[m.v5.length-1];
        let pad = "", dir = "";

        if(c.close > a.open && c.close > a.close) { pad = "ENGOLFO ALTA"; dir = "CALL"; }
        else if(c.close < a.open && c.close < a.close) { pad = "ENGOLFO BAIXA"; dir = "PUT"; }

        if(pad !== "") {
            let okM5 = (dir === "CALL" ? t5.close > t5.open : t5.close < t5.open);
            let okEMA = (dir === "CALL" ? m.ema < c.low : m.ema > c.high);

            if(okM5 && okEMA) {
                let val = (banca * (document.getElementById('inpSim').value/100)).toFixed(2);
                let t = new Date().toLocaleTimeString('pt-BR');
                if(isPre) {
                    sendTG(`âš ï¸ *ALERTA BRAIN PRO*\n\nðŸ“Š Ativo: ðŸ“Š ${m.name}\nðŸŽ¯ PadrÃ£o: ${pad}\nðŸ“ˆ Filtro: PADRÃƒO PURO âœ…\nðŸ•“ PossÃ­vel entrada: ${t}`);
                } else {
                    sendTG(`ðŸš€ *ENTRADA CONFIRMADA*\n\nðŸ‘‰Clique agora!\nðŸ“Š Ativo: ðŸ“Š ${m.name}\nðŸŽ¯ PadrÃ£o: ${pad}\nðŸ“ˆ DireÃ§Ã£o: ${dir}\nðŸ’° Entrada: R$ ${val}\nðŸ’°Banca atual: R$ ${banca.toFixed(2)}\nâ° Inicio: ${t}\nðŸ Fim: ${new Date(Date.now()+60000).toLocaleTimeString('pt-BR')}`, true);
                }
            }
        }
    }

    function update() {
        banca = parseFloat(document.getElementById('inpBanca').value);
        document.getElementById('v-banca').innerText = "R$ " + banca.toFixed(2);
        document.getElementById('v-ent').innerText = "R$ " + (banca * (document.getElementById('inpSim').value/100)).toFixed(2);
    }

    // GERA O HTML DO SELECT COM A NOVA LISTA
    function gerarOptions() {
        return LISTA_COMPLETA.map(a => `<option value="${a.id}">${a.nome}</option>`).join('');
    }

    const gr = document.getElementById('main-grid');
    for(let i=1; i<=4; i++) {
        gr.innerHTML += `<div class="card"><div class="stat-l">MONITOR ${i}</div><div class="status-box"><span id="st-${i}" class="status-txt">OFF</span><span id="pr-${i}" class="price-txt">---</span></div><select class="sel" onchange="init('${i}', this.value, this.options[this.selectedIndex].text)">${gerarOptions()}</select></div>`;
    }
    setInterval(update, 1000);
</script>
</body>
</html>
